이 파일은 이 레포에서 에이전트가 작업할 때 따라야 할 간단한 가이드와 다음 단계 TODO를 제공합니다. 이 파일의 스코프는 레포 루트 전체입니다.

== 프로젝트 스냅샷 ==
- 목적: 실시간 한국어 → 영어 음성 번역 (마이크 → VAD 문장 단위 → Whisper 번역 → TTS 재생)
- 플랫폼: Windows 우선. VB-CABLE로 Discord 등으로 라우팅 가능.
- 핵심 라이브러리: sounddevice, webrtcvad, faster-whisper, edge-tts/piper-tts, pydub(ffmpeg 필요)
- 현재 상태(완료):
  - CLI 헬퍼(디바이스/보이스 목록)
  - 실행 시 입력 장치 GUI 선택(미지정 시), 출력 장치도 GUI로 선택/저장 옵션 포함
  - 장치 인덱스/문자열 해석 유틸, Whisper 입력 16k로 자동 리샘플링
  - 기본 ASR: CPU + int8 (CUDA 미설치 환경 호환)

== 실행 요약 ==
- 가상환경 활성화 후 `python -m src.main`
- GUI로 입력/출력 장치 선택 → 번역 시작
- Edge TTS 사용 시 ffmpeg 필요(PATH 등록)

== 코드 가이드 ==
- Python 3.10–3.12, 타입힌트 유지, 모듈 간 순환참조 금지
- 변경은 최소·국소적으로, 기존 스타일 준수(간결한 함수, 명확한 이름)
- 콜백(sounddevice) 내부에서 블로킹 작업 금지; 큐 사용
- 로그/프린트는 사용자에 의미 있는 최소 정보 위주

== 다음 작업(TODO) ==
아래 항목은 중요도 순(상→하)으로 제시합니다. 각 항목에는 결과 기준을 함께 표기합니다.

1) 장치 선택 UX 강화
   - 내용: GUI에 검색/필터(입력/출력, API 종류 표기: MME/DS/WASAPI), 테스트 톤 재생 버튼 추가
   - 기준: 사용자가 선택 후 “테스트 재생 OK”를 확인 가능; 선택값을 `config/local.toml`에 저장/재사용

2) 샘플레이트 협상 및 자동 복구
   - 내용: 선택 장치의 지원 샘플레이트 조회 → 불가 시 가장 근접 값으로 자동 설정하고 리샘플
   - 기준: 44.1k/48k/96k 등에서도 오류 없이 시작되며 Whisper는 항상 16k 입력

3) 오류 처리/안내 고도화
   - 내용: PortAudio/DirectSound/WASAPI 오류 메시지 가이딩, Edge TTS 네트워크 장애 시 우회 안내
   - 기준: 대표 오류 케이스에서 사용자 친화적 팝업/문구 제공, 종료 대신 재시도 옵션

4) TTS 재생 큐/겹침 관리
   - 내용: 문장별 큐잉, 이전 발화와 겹치지 않도록 정리 및 볼륨 덕킹 옵션
   - 기준: 빠르게 연속 발화해도 재생이 끊기지 않고 질서 있게 출력

5) 스트리밍 모드(선택)
   - 내용: Whisper partial 결과를 주기적으로 받아 부분 합성/재생(Edge TTS는 문장 단위 우선)
   - 기준: 옵션으로 `stream` 활성 시 평균 지연 개선(체감 가능)

6) 단축키/상태 토글
   - 내용: 전역 Mute/Unmute, Push-To-Talk, 일시정지/재개 단축키(Windows 환경)
   - 기준: 콘솔에서 단축키로 상태 전환, 화면에 상태 표시

7) 로깅/프로파일링
   - 내용: `logging`으로 레벨별 로그, 간단한 처리시간 측정(ASR/VAD/TTS)
   - 기준: 디버그 모드에서 타임라인 확인 가능, 기본 모드에서는 최소 출력

8) 다국어 모드 지원(선택)
   - 내용: ko↔en 전환, CLI/설정으로 지정. Edge/Piper 보이스도 언어별 프리셋 제공
   - 기준: `--task transcribe/translate` + `language`로 모드 전환 확인

9) 배포/패키징
   - 내용: PyInstaller 스크립트, ffmpeg 존재 검사, README에 배포 안내 추가
   - 기준: 단일 exe로 기본 실행 가능(Edge TTS 온라인), 옵션으로 Piper 오프라인 동작 문서화

10) 테스트
   - 내용: 유닛테스트(리샘플러, VAD 세그멘터), 장치 없는 CI 환경에서는 스킵
   - 기준: `pytest -k unit` 일부 통과, 오디오 I/O 의존 항목은 분리

== 참고 ==
- 설정 병합: `config/settings.toml` + `config/local.toml`(에이전트가 저장)
- Piper 사용 시 모델 경로 필수, Edge TTS는 네트워크 의존

== 작업 원칙 ==
- 관련 없는 버그를 무리하게 동시 수정하지 말 것
- 문서/헬프(README/CLI) 최신화 동반
- 가능한 한 루트 원인에서 해결(표면적 우회 회피)

